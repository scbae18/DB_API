# API ν…μ¤νΈ κ°€μ΄λ“

μ΄ λ¬Έμ„λ” λ‹¤λ¥Έ κ°λ°μκ°€ μ΄ APIλ¥Ό μ‚¬μ©ν•κ³  ν…μ¤νΈν•λ” λ°©λ²•μ„ μ•λ‚΄ν•©λ‹λ‹¤.

## λ©μ°¨

1. [μ‚¬μ „ μ¤€λΉ„](#μ‚¬μ „-μ¤€λΉ„)
2. [ν…μ¤νΈ λ°©λ²•](#ν…μ¤νΈ-λ°©λ²•)
3. [API μ—”λ“ν¬μΈνΈ ν…μ¤νΈ](#api-μ—”λ“ν¬μΈνΈ-ν…μ¤νΈ)
4. [μ—λ¬ μΌ€μ΄μ¤ ν…μ¤νΈ](#μ—λ¬-μΌ€μ΄μ¤-ν…μ¤νΈ)
5. [μλ™ν™” ν…μ¤νΈ](#μλ™ν™”-ν…μ¤νΈ)

## μ‚¬μ „ μ¤€λΉ„

### 1. μ„λ²„ μ‹¤ν–‰ ν™•μΈ

API μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈν•μ„Έμ”:

```bash
# μ„λ²„ μ‹¤ν–‰
cd DB_API
npm install
npm start

# λλ” κ°λ° λ¨λ“
npm run dev
```

μ„λ²„κ°€ μ •μƒμ μΌλ΅ μ‹¤ν–‰λλ©΄:
- API μ„λ²„: http://localhost:3000
- Swagger λ¬Έμ„: http://localhost:3000/api-docs
- Health Check: http://localhost:3000/health

### 2. Health Check

λ¨Όμ € μ„λ²„κ°€ μ •μƒ μ‘λ™ν•λ”μ§€ ν™•μΈ:

```bash
curl http://localhost:3000/health
```

**μμƒ μ‘λ‹µ:**
```json
{
  "status": "OK",
  "message": "Server is running"
}
```

## ν…μ¤νΈ λ°©λ²•

### λ°©λ²• 1: cURL μ‚¬μ© (ν„°λ―Έλ„/λ…λ Ή ν”„λ΅¬ν”„νΈ)

#### 1. μƒν’ μ •λ³΄ μ΅°ν

```bash
curl http://localhost:3000/api/products/PRD-0001
```

**μμƒ μ‘λ‹µ:**
```json
{
  "success": true,
  "data": {
    "μƒν’ID": "PRD-0001",
    "μΉ΄ν…κ³ λ¦¬": "μλ¥",
    "μƒν’λ…": "μ¬λ¦Όν• μ²­λ°”μ§€",
    ...
  }
}
```

#### 2. νμ› μ •λ³΄ μ΅°ν

```bash
curl http://localhost:3000/api/members/USR-0001
```

#### 3. νμ› μ£Όλ¬Έ λ° μ†΅μ¥λ²νΈ μ΅°ν

```bash
curl http://localhost:3000/api/orders/member/USR-0001/tracking
```

#### 4. μ†΅μ¥λ²νΈλ΅ λ°°μ†΅μ •λ³΄ μ΅°ν

```bash
curl http://localhost:3000/api/shipments/tracking/811518691982
```

### λ°©λ²• 2: λΈλΌμ°μ €μ—μ„ μ§μ ‘ ν…μ¤νΈ

λΈλΌμ°μ € μ£Όμ†μ°½μ— URLμ„ μ…λ ¥ν•κ±°λ‚ Swagger UIλ¥Ό μ‚¬μ©ν•μ„Έμ”:

1. http://localhost:3000/api-docs μ ‘μ†
2. κ° API μ—”λ“ν¬μΈνΈλ¥Ό ν΄λ¦­
3. "Try it out" λ²„νΌ ν΄λ¦­
4. νλΌλ―Έν„° μ…λ ¥ ν›„ "Execute" ν΄λ¦­

### λ°©λ²• 3: Postman μ‚¬μ©

#### Postman μ»¬λ ‰μ… κ°€μ Έμ¤κΈ°

1. Postman μ‹¤ν–‰
2. "Import" ν΄λ¦­
3. `postman-collection.json` νμΌ μ„ νƒ (μ•„λμ—μ„ μƒμ„±)

λλ” μλ™μΌλ΅ μ”μ²­ μƒμ„±:

**μƒ μ”μ²­ μƒμ„±:**
- Method: `GET`
- URL: `http://localhost:3000/api/products/PRD-0001`
- Send ν΄λ¦­

### λ°©λ²• 4: μλ™ν™” ν…μ¤νΈ μ¤ν¬λ¦½νΈ

ν”„λ΅μ νΈμ— ν¬ν•¨λ ν…μ¤νΈ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰:

```bash
# Node.js 18+ ν•„μ”
node test-api.js

# λλ” λ‹¤λ¥Έ μ„λ²„ URLλ΅ ν…μ¤νΈ
API_URL=http://your-api-url.com node test-api.js
```

## API μ—”λ“ν¬μΈνΈ ν…μ¤νΈ

### β… μ •μƒ μΌ€μ΄μ¤ ν…μ¤νΈ

#### 1. μƒν’ μ •λ³΄ μ΅°ν

```bash
# ν…μ¤νΈ μΌ€μ΄μ¤ 1: μ΅΄μ¬ν•λ” μƒν’
curl http://localhost:3000/api/products/PRD-0001

# ν…μ¤νΈ μΌ€μ΄μ¤ 2: λ‹¤λ¥Έ μƒν’
curl http://localhost:3000/api/products/PRD-0002
```

**κ²€μ¦ ν¬μΈνΈ:**
- β… HTTP μƒνƒ μ½”λ“: 200
- β… `success: true`
- β… `data` κ°μ²΄μ— μƒν’ μ •λ³΄ ν¬ν•¨
- β… `μƒν’ID`κ°€ μ”μ²­ν• IDμ™€ μΌμΉ

#### 2. νμ› μ •λ³΄ μ΅°ν

```bash
curl http://localhost:3000/api/members/USR-0001
```

**κ²€μ¦ ν¬μΈνΈ:**
- β… HTTP μƒνƒ μ½”λ“: 200
- β… `success: true`
- β… `data` κ°μ²΄μ— νμ› μ •λ³΄ ν¬ν•¨
- β… `νμ›ID`κ°€ μ”μ²­ν• IDμ™€ μΌμΉ

#### 3. νμ› μ£Όλ¬Έ λ° μ†΅μ¥λ²νΈ μ΅°ν

```bash
curl http://localhost:3000/api/orders/member/USR-0001/tracking
```

**κ²€μ¦ ν¬μΈνΈ:**
- β… HTTP μƒνƒ μ½”λ“: 200
- β… `success: true`
- β… `data`κ°€ λ°°μ—΄ ν•νƒ
- β… κ° ν•­λ©μ— `μ£Όλ¬ΈID`μ™€ `μ†΅μ¥λ²νΈ` ν¬ν•¨

#### 4. μ†΅μ¥λ²νΈλ΅ λ°°μ†΅μ •λ³΄ μ΅°ν

```bash
curl http://localhost:3000/api/shipments/tracking/811518691982
```

**κ²€μ¦ ν¬μΈνΈ:**
- β… HTTP μƒνƒ μ½”λ“: 200
- β… `success: true`
- β… `data` κ°μ²΄μ— λ°°μ†΅ μ •λ³΄ ν¬ν•¨
- β… `μ†΅μ¥λ²νΈ`κ°€ μ”μ²­ν• λ²νΈμ™€ μΌμΉ

### β μ—λ¬ μΌ€μ΄μ¤ ν…μ¤νΈ

#### 1. μ΅΄μ¬ν•μ§€ μ•λ” λ¦¬μ†μ¤ μ΅°ν

```bash
# μ΅΄μ¬ν•μ§€ μ•λ” μƒν’
curl http://localhost:3000/api/products/PRD-9999

# μ΅΄μ¬ν•μ§€ μ•λ” νμ›
curl http://localhost:3000/api/members/USR-9999

# μ΅΄μ¬ν•μ§€ μ•λ” μ†΅μ¥λ²νΈ
curl http://localhost:3000/api/shipments/tracking/000000000000
```

**μμƒ μ‘λ‹µ:**
```json
{
  "success": false,
  "message": "μƒν’μ„ μ°Ύμ„ μ μ—†μµλ‹λ‹¤."
}
```

**κ²€μ¦ ν¬μΈνΈ:**
- β… HTTP μƒνƒ μ½”λ“: 404
- β… `success: false`
- β… μ μ ν• μ—λ¬ λ©”μ‹μ§€ ν¬ν•¨

#### 2. μλ»λ URL ν•μ‹

```bash
# μλ»λ μ—”λ“ν¬μΈνΈ
curl http://localhost:3000/api/invalid-endpoint
```

**μμƒ μ‘λ‹µ:**
```json
{
  "success": false,
  "message": "μ”μ²­ν• λ¦¬μ†μ¤λ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤."
}
```

**κ²€μ¦ ν¬μΈνΈ:**
- β… HTTP μƒνƒ μ½”λ“: 404

## κ³ κΈ‰ ν…μ¤νΈ μ‹λ‚λ¦¬μ¤

### μ‹λ‚λ¦¬μ¤ 1: μ „μ²΄ μ£Όλ¬Έ μ¶”μ  ν”λ΅μ°

1. νμ›IDλ΅ μ£Όλ¬Έ λ©λ΅ μ΅°ν
2. μ²« λ²μ§Έ μ£Όλ¬Έμ μ†΅μ¥λ²νΈ μ¶”μ¶
3. μ†΅μ¥λ²νΈλ΅ λ°°μ†΅μ •λ³΄ μ΅°ν

```bash
# 1λ‹¨κ³„: νμ› μ£Όλ¬Έ μ΅°ν
RESPONSE=$(curl -s http://localhost:3000/api/orders/member/USR-0001/tracking)

# 2λ‹¨κ³„: μ²« λ²μ§Έ μ†΅μ¥λ²νΈ μ¶”μ¶ (jq ν•„μ”)
TRACKING_NUMBER=$(echo $RESPONSE | jq -r '.data[0].μ†΅μ¥λ²νΈ')

# 3λ‹¨κ³„: λ°°μ†΅μ •λ³΄ μ΅°ν
curl http://localhost:3000/api/shipments/tracking/$TRACKING_NUMBER
```

### μ‹λ‚λ¦¬μ¤ 2: μ—¬λ¬ μƒν’ μ΅°ν

```bash
# μ—¬λ¬ μƒν’μ„ μμ°¨μ μΌλ΅ μ΅°ν
for i in {1..5}; do
  curl http://localhost:3000/api/products/PRD-$(printf "%04d" $i)
  echo ""
done
```

## ν…μ¤νΈ μ²΄ν¬λ¦¬μ¤νΈ

### κΈ°λ³Έ κΈ°λ¥ ν…μ¤νΈ

- [ ] Health check μ—”λ“ν¬μΈνΈ μ‘λ™ ν™•μΈ
- [ ] μƒν’ μ •λ³΄ μ΅°ν (μ΅΄μ¬ν•λ” μƒν’)
- [ ] νμ› μ •λ³΄ μ΅°ν (μ΅΄μ¬ν•λ” νμ›)
- [ ] νμ› μ£Όλ¬Έ λ° μ†΅μ¥λ²νΈ μ΅°ν
- [ ] μ†΅μ¥λ²νΈλ΅ λ°°μ†΅μ •λ³΄ μ΅°ν

### μ—λ¬ μ²λ¦¬ ν…μ¤νΈ

- [ ] μ΅΄μ¬ν•μ§€ μ•λ” μƒν’ μ΅°ν (404)
- [ ] μ΅΄μ¬ν•μ§€ μ•λ” νμ› μ΅°ν (404)
- [ ] μ΅΄μ¬ν•μ§€ μ•λ” μ†΅μ¥λ²νΈ μ΅°ν (404)
- [ ] μλ»λ URL ν•μ‹ (404)

### μ‘λ‹µ ν•μ‹ κ²€μ¦

- [ ] λ¨λ“  μ„±κ³µ μ‘λ‹µμ— `success: true` ν¬ν•¨
- [ ] λ¨λ“  μ—λ¬ μ‘λ‹µμ— `success: false` ν¬ν•¨
- [ ] μ μ ν• HTTP μƒνƒ μ½”λ“ λ°ν™
- [ ] JSON ν•μ‹μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈ

### μ„±λ¥ ν…μ¤νΈ (μ„ νƒμ‚¬ν•­)

```bash
# μ‘λ‹µ μ‹κ°„ μΈ΅μ •
time curl http://localhost:3000/api/products/PRD-0001

# μ—¬λ¬ μ”μ²­ λ™μ‹ μ‹¤ν–‰
for i in {1..10}; do
  curl http://localhost:3000/api/products/PRD-0001 &
done
wait
```

## μλ™ν™” ν…μ¤νΈ

### Node.js ν…μ¤νΈ μ¤ν¬λ¦½νΈ μ‹¤ν–‰

```bash
# κΈ°λ³Έ ν…μ¤νΈ (localhost:3000)
node test-api.js

# λ‹¤λ¥Έ μ„λ²„ URLλ΅ ν…μ¤νΈ
API_URL=https://your-api.com node test-api.js
```

### μμƒ μ¶λ ¥

```
π§ API ν…μ¤νΈ μ‹μ‘

π“ Base URL: http://localhost:3000

==================================================

β… Health Check
   Status: 200 (expected: 200)
   Response: {
  "status": "OK",
  "message": "Server is running"
}...

β… μƒν’ μ •λ³΄ μ΅°ν (PRD-0001)
   Status: 200 (expected: 200)
   Response: {
  "success": true,
  "data": {
    "μƒν’ID": "PRD-0001",
    ...
  }
}...

...

==================================================

π“ ν…μ¤νΈ κ²°κ³Ό μ”μ•½

β… Health Check - PASS
β… μƒν’ μ •λ³΄ μ΅°ν (PRD-0001) - PASS
β μ΅΄μ¬ν•μ§€ μ•λ” μƒν’ μ΅°ν - PASS
...

μ΄ 7κ° ν…μ¤νΈ μ¤‘ 7κ° μ„±κ³µ, 0κ° μ‹¤ν¨

π‰ λ¨λ“  ν…μ¤νΈκ°€ ν†µκ³Όν–μµλ‹λ‹¤!
```

## λ¬Έμ  ν•΄κ²°

### μ„λ²„κ°€ μ‘λ‹µν•μ§€ μ•λ” κ²½μ°

1. μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ: `curl http://localhost:3000/health`
2. ν¬νΈκ°€ μ¬λ°”λ¥Έμ§€ ν™•μΈ (κΈ°λ³Έκ°’: 3000)
3. λ°©ν™”λ²½ μ„¤μ • ν™•μΈ

### λ°μ΄ν„°κ°€ μ—†λ” κ²½μ°

1. λ°μ΄ν„°λ² μ΄μ¤ λ§μ΄κ·Έλ μ΄μ… μ‹¤ν–‰:
   ```bash
   node scripts/create-tables.js
   npm run migrate
   ```

2. λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° ν™•μΈ:
   - `.env` νμΌμ `DATABASE_URL` ν™•μΈ
   - Neon λ°μ΄ν„°λ² μ΄μ¤κ°€ ν™μ„±ν™”λμ–΄ μλ”μ§€ ν™•μΈ

### CORS μ¤λ¥

λΈλΌμ°μ €μ—μ„ ν…μ¤νΈν•  λ• CORS μ¤λ¥κ°€ λ°μƒν•λ©΄:
- μ„λ²„μ CORS μ„¤μ • ν™•μΈ
- ν•„μ”μ‹ `server.js`μ CORS μ„¤μ • μμ •

## μ¶”κ°€ λ¦¬μ†μ¤

- **Swagger λ¬Έμ„**: http://localhost:3000/api-docs
- **API λ£¨νΈ**: http://localhost:3000/
- **Health Check**: http://localhost:3000/health

## λ¬Έμ

ν…μ¤νΈ μ¤‘ λ¬Έμ κ°€ λ°μƒν•λ©΄:
1. Swagger λ¬Έμ„μ—μ„ API μ¤ν™ ν™•μΈ
2. μ„λ²„ λ΅κ·Έ ν™•μΈ
3. μ΄μ λ“±λ΅
